var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i},Competition;(function(n){var t=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.page=0,i.pageSubmission=0,i.loadSucess=!1,i.loadSucessSubmisstion=!1,i.timerId=0,i.prototype.requestPartialViewcontroller=function(n){i.prototype.hidePhaseToggleBtn();var r=$("#CompetitionId").val(),u="/competitions/details/"+r+"/page/"+n,f=function(t){$(".competitionsDetailTabTop > li.active").hasClass("tab1")?$("#subContainerBlock").append(t):($("#subContainerBlockForParticipate").html(""),$("#subContainerBlockForParticipate").append(t),n===10&&(i.pageSubmission=0,$("#resultSubmissionResults > tr").remove(),$("#selctedPhaseButton").val($("#activePhase").val()),i.prototype.getSubmissionsPageResults($("#activePhase").val()),i.prototype.togglePhases($("#activePhase").val()),$("#uploadFile").change(function(){i.prototype.uploadFile(2)}),$("#submitResults").click(function(){$("#uploadFile").click()}),i.prototype.showPhaseToggleBtn())),$(".CompetitionsDetailLftUl > li").removeClass("active"),$("#tab"+n).addClass("active"),i.prototype.hideProcess()},e=function(){i.prototype.hideProcess()};t.prototype.ajaxGetRequest.call(this,u,f,e)},i.prototype.requestPartialView=function(n){$(".preloader").show(),$(".tabArea").hide();var r=$(n).attr("id"),t=$.trim(r.replace("tab",""));$(".CompetitionsDetailLft li").removeClass("active"),$(n).addClass("active"),$("#"+r+"_"+t).length===0?(i.prototype.requestPartialViewcontroller(parseInt(t)),parseInt(t)===1&&$("#statusBar").show()):($("#"+r+"_"+t).show(),parseInt(t)===1&&$("#statusBar").show(),i.prototype.hideProcess())},i.prototype.hideProcess=function(){$(".preloader").hide()},i.prototype.hideDialog=function(){$(".popupContainer,.grayOverlaper").hide()},i.prototype.checkRegisterStatus=function(){$(".preloader").show();var n="/api/competitionparticipantstatus/"+$("#CompetitionId").val(),r=function(n){i.prototype.setRegisterButtonLabel(n.status,n.reason),i.prototype.hideDialog(),i.prototype.hideProcess()},u=function(){i.prototype.setRegisterButtonLabel(999,""),i.prototype.hideDialog(),i.prototype.hideProcess()};t.prototype.ajaxGetRequest.call(this,n,r,u)},i.prototype.saveUserRegisterStatus=function(){var n="/api/competitionparticipantstatus/"+$("#CompetitionId").val(),r=function(){i.prototype.checkRegisterStatus()},u=function(){i.prototype.hideDialog()};t.prototype.ajaxPostRequest.call(this,n,r,u)},i.prototype.setRegisterButtonLabel=function(n,t){i.prototype.hideAllTabSections();switch(n){case 0:i.prototype.showRegisterButton("register","You have not yet registered for this competition"),i.prototype.showRegisterSection();break;case 1:i.prototype.showRegisterLabel("Your registration is pending approval"),$("#participateInfoBlock").addClass("pendingApproval");break;case 2:$("#participateInfoBlock").hide(),i.prototype.showTabSections();break;case 3:i.prototype.showRegisterLabel("Your registration has been rejected."),$("#rejectionReasonLabel").show(),$("#rejectionReasonLabel").text(t),$("#participateInfoBlock").addClass("rejectedApproval");break;default:i.prototype.showRegisterLabel("status not available")}},i.prototype.showRegisterButton=function(n,t){$(".buttonPreloader").hide(),$(".blueRegButton").show(),$("#registerCompetition").text(n),$("#registerCompetitionLabel").text(t)},i.prototype.showRegisterLabel=function(n){$(".buttonPreloader").hide(),$(".blueRegButton").hide(),$("#registerCompetitionLabel").text(n),$("#registerCompetitionLabel").show()},i.prototype.allowRegister=function(){$("#chkRegister").is(":checked")===!0?$("#registerCompetition").removeClass("disabledStatus"):$("#registerCompetition").addClass("disabledStatus")},i.prototype.getCompetitionResults=function(n){var r;if($("#seeTheResults div.competitionTileNoRecord").remove(),i.page>-1){$("#seeTheResults tr:first").show(),$("<tr id='preLoaderRow'><td colspan='5'><div class='coloumPreloader'><\/div><\/td><\/tr>").insertAfter($("#seeTheResults tr:last")),r={pageNumber:i.page,pageSize:6},i.page++;var u="/Competitions/"+$("#CompetitionId").val()+"/results/"+n+"/"+parseInt($("#selectedRank").val()),f=function(t){$(t).text()!=="There are no results."?(i.loadSucess=!0,$("#seeTheResults").append(t),$("#preLoaderRow").remove(),$("body").outerHeight()<$(window).height()&&i.prototype.getCompetitionResults(n),$("#seeTheResults tr.trHearder").length>1&&$("#seeTheResults tr:first").remove(),$(".trHearder").find(".rankHeader").each(function(){$(this).click(function(){i.page=0,$("#selectedRank").val($(this).children("input:hidden").val()),$("#seeTheResults tr:gt(0)").remove(),i.prototype.getCompetitionResults($("#selctedPhaseButton").val())})})):(i.page===1&&($("#seeTheResults").append('<div class="competitionTileNoRecord">'+t+"<\/div>"),$("#seeTheResults tr:first").hide()),i.page=-1,$("#preLoaderRow").remove())},e=function(){$("#preLoaderRow").remove()};t.prototype.ajaxJSONRequest.call(this,u,f,e,r)}},i.prototype.showTabSections=function(){$("#tabParticipantContainer").show()},i.prototype.showPhaseToggleBtn=function(){$("#phaseToggleBtnContainerSubmitPage").show()},i.prototype.hidePhaseToggleBtn=function(){$("#phaseToggleBtnContainerSubmitPage").hide()},i.prototype.hideAllTabSections=function(){$("#tabParticipantContainer").hide(),$("#registerOptionContainer").hide(),$("#rejectionReasonLabel").hide(),i.prototype.hidePhaseToggleBtn()},i.prototype.showRegisterSection=function(){$("#registerOptionContainer").show()},i.prototype.getLftTabsForCompetition=function(n){$(".preloader").show();var u="/competitions/details/"+$("#CompetitionId").val()+"/tab/ "+n,r,f=function(t){n===0?($("#CompetitionsDetailLftLtd").html(""),$("#CompetitionsDetailLftLtd").append(t),$(".CompetitionsDetailLftUl > li").removeClass("active"),$("#CompetitionsDetailLftLtd > li:first").addClass("active"),r=$("#CompetitionsDetailLftLtd > li:first").attr("id")):($("#CompetitionsDetailLftParticipate").html(""),$("#CompetitionsDetailLftParticipate").append(t),$(".CompetitionsDetailLftUl > li").removeClass("active"),$("#CompetitionsDetailLftParticipate > li:first").addClass("active"),r=$("#CompetitionsDetailLftParticipate > li:first").attr("id")),$(".CompetitionsDetailLftUl > li").click(function(){var n=$(this).attr("class");$(this).hasClass("active")||($(".CompetitionsDetailLftUl > li").removeClass("active"),$(this).addClass("active"),i.prototype.requestPartialView(this),window.location.hash=$.trim($.trim($(".competitionsDetailTabTop > li.active").attr("class").replace("active",""))+"-"+$(this).attr("id")))}),i.prototype.getTabSelectionIdentifiersFromURL(),i.currentSubTab?i.prototype.requestPartialViewcontroller(parseInt($.trim(i.currentSubTab.replace("tab","")))):i.prototype.requestPartialViewcontroller(parseInt($.trim(r.replace("tab",""))))},e=function(){};t.prototype.ajaxGetRequest.call(this,u,f,e)},i.prototype.getSubmissionsPageResults=function(n){var r;if($("#resultSubmissionResults div.competitionTileNoRecord").remove(),i.pageSubmission>-1){$("#resultSubmissionResults tr:first").show(),$("<tr id='preLoaderRow'><td colspan='4'><div class='coloumPreloader'><\/div><\/td><\/tr>").insertAfter($("#resultSubmissionResults tr:last")),r={pageNumber:i.pageSubmission,pageSize:6},i.pageSubmission++;var u="/Competitions/"+$("#CompetitionId").val()+"/submissions/"+n,f=function(t){$(t).text()!=="There are no previous submissions."?(i.loadSucessSubmisstion=!0,$("#resultSubmissionResults").append(t),$("#preLoaderRow").remove(),$(".toggleIconExp").unbind("click").click(function(){$(this).parents(".toggleTble").next("div").toggleClass("preSubmissionToggleView preSubmissionToggle"),$(this).toggleClass("toggleIconColp toggleIconExp")}),$(".leaderboardUpdate").click(function(){var n=$(this).parents(".preSubmissionToggleView").siblings(".toggleTble").find("tr td:first").text();i.prototype.updateLeaderBoard(parseInt(n),this)}),$(".leaderboardDelete").click(function(){i.prototype.deleteLeaderBoard(this)}),$(".globalBlueButtonSmallFlexi").click(function(){var n=$(this).parents(".preSubmissionToggleView").siblings(".toggleTble").find("tr td:first").text(),t=$(this).attr("id");i.prototype.openSubStandardWindow(n,t)}),$("body").outerHeight()<$(window).height()&&i.prototype.getSubmissionsPageResults(n)):(i.pageSubmission===1&&($("#resultSubmissionResults").append('<div class="competitionTileNoRecord">'+t+"<\/div>"),$("#resultSubmissionResults tr:first").hide()),i.pageSubmission=-1,$("#preLoaderRow").remove()),i.prototype.getCurrentLederBoardDetails(),FileUpload.FileUploadFile.uploadResult==!0&&($("#resultSubmissionResults").children("tr:first").find("td:#status").text("Processing"),FileUpload.FileUploadFile.uploadResult=!1)},e=function(){$("#preLoaderRow").remove()};t.prototype.ajaxJSONRequest.call(this,u,f,e,r)}},i.prototype.openSubStandardWindow=function(n,t){var i=$("#selctedPhaseButton").val(),r=$("#CompetitionId").val(),u="/"+r+"/"+i+"/"+n+"/"+t;window.open(u)},i.prototype.getCurrentLederBoardDetails=function(){var n="/api/competition/"+parseInt($("#CompetitionId").val())+"/leaderboard/entry/1/submission/1",i=function(n){var t=$(".resultSubResultsContainer").find("tr td:first:contains('"+n.number+"')").siblings("td.ticked").find("div");$(t).removeClass("leaderboardHidden"),$(t).addClass("leaderboardVisible"),$(t).parents(".toggleTble").siblings(".preSubmissionToggle").find("a.leaderboardbuttonHidden").removeClass("leaderboardbuttonHidden"),$(t).parents(".toggleTble").siblings(".preSubmissionToggle").find("a.leaderboardUpdate").addClass("leaderboardbuttonHidden")},r=function(){};t.prototype.ajaxGetRequest.call(this,n,i,r)},i.prototype.updateLeaderBoard=function(n,i){var u,r,f,e;$(i).addClass("disabledStatus"),u="/api/competition/"+parseInt($("#CompetitionId").val())+"/leaderboard/entry/1/submission/"+n,r=new FormData,r!==undefined&&r.append("submissionId",2),f=function(){$("a.leaderboardDelete").addClass("leaderboardbuttonHidden"),$("a.leaderboardUpdate").removeClass("leaderboardbuttonHidden"),$(".leaderboardVisible").addClass("leaderboardHidden"),$(i).siblings("a").removeClass("leaderboardbuttonHidden"),$(i).addClass("leaderboardbuttonHidden");var n=$(i).parents(".preSubmissionToggleView").siblings(".toggleTble").find("tr td.ticked div");$(n).removeClass("leaderboardHidden"),$(n).addClass("leaderboardVisible"),$(i).removeClass("disabledStatus")},e=function(){$(i).removeClass("disabledStatus")},t.prototype.ajaxPostRequest.call(this,u,f,e)},i.prototype.deleteLeaderBoard=function(n){$(n).addClass("disabledStatus");var i="/api/competition/"+parseInt($("#CompetitionId").val())+"/leaderboard/entry/1/submission/1/",r=function(){$(".leaderboardVisible").addClass("leaderboardHidden"),$(n).siblings("a").removeClass("leaderboardbuttonHidden"),$(n).addClass("leaderboardbuttonHidden");var t=$(n).parents(".preSubmissionToggleView").siblings(".toggleTble").find("tr td.ticked div");$(t).removeClass("leaderboardVisible"),$(t).addClass("leaderboardHidden"),$(n).removeClass("disabledStatus")},u=function(){$(n).removeClass("disabledStatus")};t.prototype.ajaxGeneralRequest.call(this,i,r,u,"Delete")},i.prototype.getAcivePhase=function(){var n="/api/competition/"+parseInt($("#CompetitionId").val())+"/active-phase",r=function(n){var t,r;$("#activePhase").val(n.active),$("#selctedPhaseButton").val(n.active),t="";for(r in n.phases.phases)t=t+"<section><label>"+n.phases.phases[r].label+"<\/br>",t=t+"<span> begins "+$.datepicker.formatDate("mm/dd/yy",new Date(n.phases.phases[r].startDate))+"<\/span><\/label><\/section>";t=t+"<section><label> Competition <\/br>",t=n.phases.endDate!==undefined&&n.phases.endDate!==null?t+"<span> ends"+$.datepicker.formatDate("mm/dd/yy",new Date(n.phases.endDate))+"<\/span>":t+"<span> has no end <\/span>",t=t+"<\/label><\/section>",$(".challStatusStripSection").append(t),i.prototype.showPhaseButtons(n),i.currentMainTab==="tab3"&&(i.page=0,i.prototype.getCompetitionResults($("#activePhase").val()))},u=function(){};t.prototype.ajaxGetRequest.call(this,n,r,u)},i.prototype.togglePhases=function(n){var t=$("#phaseToggleBtnContainerSubmitPage div"),i=$("#phaseToggleBtnContainerResultpage div");$(t).addClass("disabled"),$(t).addClass("disabledStatus"),$(i).addClass("disabledStatus"),$("#phaseToggleBtnContainerSubmitPage div span").remove(),$("#phaseToggleBtnContainerResultpage div span").remove(),n>0?($(t).eq(n-1).removeClass("disabled"),$(t).eq(n-1).removeClass("disabledStatus"),$(t).eq(n-1).append("<span ><\/span>"),$(i).eq(n-1).removeClass("disabled"),$(i).eq(n-1).removeClass("disabledStatus"),$(i).eq(n-1).append("<span ><\/span>")):($("#plblSubmission").text("This phase of the competition has not started.You cannot submit results at this time."),$("#submitResults").parent("div").hide(),$(t).eq(0).removeClass("disabled"),$(t).eq(0).removeClass("disabledStatus"),$(i).eq(0).removeClass("disabled"),$(i).eq(0).removeClass("disabledStatus"))},i.prototype.showPhaseButtons=function(t){var u,f,r,e;$("#phaseToggleBtnContainerSubmitPage").html(""),$("#phaseToggleBtnContainerResultpage").html(""),u="",f="";for(r in t.phases.phases)u=u+"<div  class ='globalBlueButton phaseToggleBtn lFloat' id='submission"+r.toString()+"'><a>"+t.phases.phases[r].label+"<\/a><\/div>",f=f+"<div  class ='globalBlueButton phaseToggleBtn lFloat' id='result"+r.toString()+"'><a>"+t.phases.phases[r].label+"<\/a><\/div>";$("#phaseToggleBtnContainerSubmitPage").append(u),$("#phaseToggleBtnContainerResultpage").append(f),e=parseInt($("#activePhase").val()),i.prototype.togglePhases(e),$("#phaseToggleBtnContainerSubmitPage div").each(function(){$(this).click(function(){parseInt($("#activePhase").val())!==0&&($(this).hasClass("disabled")?$("#submitResults").parent("div").hide():$("#submitResults").parent("div").show()),$("#phaseToggleBtnContainerSubmitPage div").addClass("disabledStatus"),$(this).removeClass("disabledStatus"),$(this).addClass(""),$("#resultSubmissionResults tr:gt(0)").remove();var t=parseInt($.trim($(this).attr("id").replace("submission","")))+1;$("#selctedPhaseButton").val(t.toString()),t<parseInt($("#activePhase").val())?$("#plblSubmission").text("View your previous submissions"):t===parseInt($("#activePhase").val())?$("#plblSubmission").text("Submit a new result set or view your previous submissions."):$("#plblSubmission").text("This phase of the competition has not started. You cannot submit results at this time"),n.CompetitionDetails.pageSubmission=0,i.prototype.getSubmissionsPageResults($("#selctedPhaseButton").val())})}),$("#phaseToggleBtnContainerResultpage div").each(function(){$(this).click(function(){$("#phaseToggleBtnContainerResultpage div").addClass("disabledStatus"),$(this).removeClass("disabledStatus"),$("#selctedPhaseButton").val((parseInt($.trim($(this).attr("id").replace("result","")))+1).toString()),$("#seeTheResults tr:gt(0)").remove(),n.CompetitionDetails.page=0,$("#selectedRank").val("1"),i.prototype.getCompetitionResults($("#selctedPhaseButton").val())})})},i.prototype.getTabSelectionIdentifiersFromURL=function(){i.currentMainTab=undefined,i.currentSubTab=undefined;var n=window.location.hash.split("-");if(n!==undefined)switch(n.length){case 1:$.trim(n[0])!==""&&(i.currentMainTab=$.trim(n[0].replace("#","")),i.currentSubTab=undefined);break;case 2:i.currentMainTab=$.trim(n[0].replace("#","")),i.currentSubTab=$.trim(n[1])}},i.prototype.getTabSelectionbyDefalut=function(){if(i.prototype.getTabSelectionIdentifiersFromURL(),i.currentMainTab){if(i.prototype.activateMainTab(i.currentMainTab),i.currentMainTab!=="tab3"){var n=i.currentMainTab.replace("tab","");i.prototype.getLftTabsForCompetition(parseInt(n)-1)}}else i.prototype.getLftTabsForCompetition(0)},i.prototype.redirectToCompetitionRules=function(){window.open("/competitions/details/"+$("#CompetitionId").val()+"#tab1-tab3")},i.prototype.fmt2=function(n){var t=n.toString();return t.length==1&&(t="0"+t),t},i.prototype.lastModifiedDateLabel=function(n){var t;if($.browser.msie&&parseInt($.browser.version)===8){t=new Date;var r=parseInt(n.substring(8,10),10),u=parseInt(n.substring(5,7),10),f=parseInt(n.substring(0,4),10),e=parseInt(n.substring(11,13),10),o=parseInt(n.substring(14,16),10),s=parseInt(n.substring(17,19),10);t.setUTCDate(r),t.setUTCMonth(u),t.setUTCFullYear(f),t.setUTCHours(e),t.setUTCMinutes(o),t.setUTCSeconds(s)}else t=new Date(n);var h=$.datepicker.formatDate("M dd, yy",t).toString(),c=t.getHours().toString(),l=i.prototype.fmt2(t.getMinutes()),a=i.prototype.fmt2(t.getSeconds());return"Last modified: "+h+" at "+c+":"+l+":"+a},i.prototype.activateMainTab=function(n){$(".competitionsDetailTabTop > li").removeClass("active"),$("."+n).addClass("active"),$(".competitionsDetailTabBlock > li").css("display","none"),$(".competitionsDetailTabBlock").children("."+n).css("display","block")},i}(FileUpload.FileUploadFile);n.CompetitionDetails=t})(Competition||(Competition={})),$(function(){var n=new Competition.CompetitionDetails;Competition.CompetitionDetails.page=0,n.getTabSelectionIdentifiersFromURL(),$(".headerContent li.active").removeClass("active"),$("#liCompetition").addClass("active"),$("#registerCompetition").click(function(){$("#registerCompetition").hasClass("disabledStatus")||($("#registerOptionContainer").hide(),n.saveUserRegisterStatus())}),$(".preloader").show(),$(".tabArea").hide(),$("#registerCompetition").addClass("disabledStatus"),$("#chkRegister").click(function(){n.allowRegister()}),$(".competitionsDetailTabTop > li").click(function(){var t=$(this).attr("class");n.getTabSelectionIdentifiersFromURL(),$(this).hasClass("active")||(n.activateMainTab(t),Competition.CompetitionDetails.currentMainTab||(window.location.hash=""),$(this).hasClass("tab3")?(Competition.CompetitionDetails.currentMainTab!=="tab3"&&(window.location.hash="tab3"),Competition.CompetitionDetails.page=0,$("#seeTheResults > tr").remove(),$("#selctedPhaseButton").val($("#activePhase").val()),n.getCompetitionResults($("#activePhase").val())):$(this).hasClass("tab2")?(Competition.CompetitionDetails.currentMainTab!=="tab2"&&(window.location.hash="tab2"),$(".tabArea").hide(),$("#subContainerBlockForParticipate").html(""),$(".CompetitionsDetailLftUl > li").removeClass("active"),n.getLftTabsForCompetition(1)):(Competition.CompetitionDetails.currentMainTab!=="tab1"&&(window.location.hash="tab1"),$("#subContainerBlock").html(""),$(".CompetitionsDetailLftUl > li").removeClass("active"),n.getLftTabsForCompetition(0)))}),window.onresize=function(){Competition.CompetitionDetails.loadSucess&&n.getCompetitionResults($("#selctedPhaseButton").val())},n.getAcivePhase(),n.getTabSelectionbyDefalut(),$("#lblLastModifiedDate").text($("#lblLastModifiedDate").text()+" "+n.lastModifiedDateLabel($("#LastModified").val())),window.onscroll=function(){$(window).scrollTop()==$(document).height()-$(window).height()-1&&($(".competitionsDetailTabTop > li.active").hasClass("tab3")?n.getCompetitionResults($("#selctedPhaseButton").val()):$(".competitionsDetailTabTop > li.active").hasClass("tab2")&&$("#tab10").hasClass("active")&&n.getSubmissionsPageResults($("#selctedPhaseButton").val()))}})